<x-vid>
<script>
// First we specify bitrates to feed to the player
var bitrates = {
	mp4: [
	'//cdn.rawgit.com/cekvenich/what/master/asites/arc.mp4'
]}

this.on('before-unmount', function(){
	console.log('bu')
})
this.on('unmount', function(){
	console.log('u')

})

// Then we set our player settings
var vsettings = {
	licenseKey : 'Kl8laT0wZWswM3VlOGt6PTdzZWsyZW9kP3JvbTVkYXNpczMwZGIwQSVfKg==',
	initialVolume: 0,
	muted: true,
	width: 360,
	height: 250,
	scaleMode: 'stretch',
	posterScaleMode: 'stretch',
	bitrates: bitrates,
	poster: '//www.radiantmediaplayer.com/images/poster-rmp-showcase.jpg',
	autoplay: true,
	mutedAutoplayOnMobile: true,
	delayToFade: 1000,
	loop: true
}

this.on('mount', function(){
	vidInit(this.opts)
	// page action
	A.stateA.add(function(arg1, arg2) {
		try { 	// //cdn.radiantmediatechs.com/rmp/v4/latest/js/rmp.debug.js
		console.log(arg1, document.URL )
		var shouldRemove = false
		if((document.URL.indexOf('/feed')!= -1) && (A.PAGE == arg1)) 
			shouldRemove = true

		if(!shouldRemove) return
		console.log('removing players')
		if(players) {
			while (players.length>0) { // stop each player
				var rmp = players.pop()
				rmp.stop()
				rmp.destroy()
			}//while
		}//fi
		} catch (er) {console.log(er)}
	})
})



var players = []
function vidInit(tag) {
	// Reference to the wrapper div (unique id)
	//console.log(JSON.stringify(tag))
	vsettings.poster = tag.poster
	bitrates.mp4[0] = tag.bitrate1
	var ei = tag.zid
	console.log(ei)
	var rmp = new RadiantMP(ei)
	players.push(rmp)
	rmp.init(vsettings)
}

</script>

</x-vid>